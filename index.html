<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animated Ball with Gravity</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="content">
        <h1>MISIEK</h1>
    </div>
    <div id="menuContainer">
        <div id="menuToggle" onclick="toggleMenu()">&#9664;</div>
        <div id="menu">
            <label for="ballColor">Ball Color:</label><br>
            <input type="color" id="ballColor" value="#ff0000"><br>
            <label for="ballSize">Ball Size:</label><br>
            <input type="number" id="ballSize" value="50"><br>
            <label for="ballSpeed">Ball Speed:</label><br>
            <input type="number" id="ballSpeed" value="2"><br>
            <button class="button" onclick="addBall()">Add Ball</button><br><br>
            <label for="statsToggle">Show Stats:</label><br>
            <input type="checkbox" id="statsToggle" onchange="toggleStats()"><br><br>
            <button class="button" onclick="changeBackground()">Change Background</button><br><br>
            <label for="motionBlur">Motion Blur:</label><br>
            <input type="range" id="motionBlur" min="0" max="20" value="0" oninput="updateMotionBlur(this.value)"><br>
            <span id="blurValue">0px</span>
        </div>
    </div>
    <div id="helpBox" onclick="toggleMenu()">?</div>
    <div id="stats" style="display: none;">
        Bounce Count: <span id="bounceCount">0</span><br>
        Ball Count: <span id="ballCount">0</span>
    </div>

    <script>
        let balls = [];
        let gravity = 0.2;
        let boostCounter = 0;
        const boostAmount = 10;
        let statsVisible = false;
        let bounceCounter = 0;
        let menuVisible = true;
        let motionBlur = 0;

        function addBall() {
            let size = document.getElementById("ballSize").value;
            let speed = document.getElementById("ballSpeed").value;
            let color = document.getElementById("ballColor").value;
            createBall(size, speed, color);
            document.getElementById("ballCount").innerText = balls.length;
            animateHeader();
        }

        function createBall(size, speed, color) {
            let ball = document.createElement("div");
            ball.className = "ball";
            ball.style.width = size + "px";
            ball.style.height = size + "px";
            ball.style.backgroundColor = color;
            ball.style.left = Math.random() * (window.innerWidth - size) + "px";
            ball.style.top = Math.random() * (window.innerHeight - size) + "px";
            document.body.appendChild(ball);
            balls.push({ element: ball, speedX: Math.random() * 10 - 5, speedY: parseFloat(speed), bounceCount: 0 });
        }

        function getRandomColor() {
            return '#' + Math.floor(Math.random() * 16777215).toString(16);
        }

        function update() {
            for (let i = 0; i < balls.length; i++) {
                let ballA = balls[i];
                let currentTopA = parseFloat(ballA.element.style.top);
                let currentLeftA = parseFloat(ballA.element.style.left);
                let sizeA = parseFloat(ballA.element.style.height);

                for (let j = i + 1; j < balls.length; j++) {
                    let ballB = balls[j];
                    let currentTopB = parseFloat(ballB.element.style.top);
                    let currentLeftB = parseFloat(ballB.element.style.left);
                    let sizeB = parseFloat(ballB.element.style.height);

                    let dx = currentLeftB - currentLeftA;
                    let dy = currentTopB - currentTopA;
                    let distance = Math.sqrt(dx * dx + dy * dy);
                    let minDistance = sizeA / 2 + sizeB / 2;

                    if (distance < minDistance) {
                        let angle = Math.atan2(dy, dx);
                        let targetX = currentLeftA + Math.cos(angle) * minDistance;
                        let targetY = currentTopA + Math.sin(angle) * minDistance;

                        let ax = (targetX - currentLeftA) * 0.1;
                        let ay = (targetY - currentTopA) * 0.1;

                        ballA.speedX -= ax;
                        ballA.speedY -= ay;
                        ballB.speedX += ax;
                        ballB.speedY += ay;
                    }
                }

                if (currentTopA >= window.innerHeight - sizeA) {
                    ballA.speedY *= -0.9;
                    ballA.bounceCount++;
                    bounceCounter++;
                    if (ballA.bounceCount % 10 === 0) {
                        ballA.speedY -= boostAmount;
                    }
                } else if (currentTopA <= 0) {
                    ballA.speedY *= -1;
                } else {
                    ballA.speedY += gravity;
                }

                if (currentLeftA <= 0 || currentLeftA >= window.innerWidth - sizeA) {
                    ballA.speedX *= -1;
                }

                ballA.element.style.top = Math.min(Math.max(currentTopA + ballA.speedY, 0), window.innerHeight - sizeA) + "px";
                ballA.element.style.left = Math.min(Math.max(currentLeftA + ballA.speedX, 0), window.innerWidth - sizeA) + "px";
                ballA.element.style.filter = `blur(${motionBlur}px)`;  // Apply motion blur effect
            }

            document.getElementById("bounceCount").innerText = bounceCounter;

            requestAnimationFrame(update);
        }

        function toggleMenu() {
            let menu = document.getElementById("menu");
            let menuToggle = document.getElementById("menuToggle");
            if (menuVisible) {
                menu.style.maxHeight = "0";
                menu.style.opacity = "0";
                menu.style.padding = "0";
                menuToggle.innerHTML = "&#9664;";
            } else {
                menu.style.maxHeight = "300px"; // Możesz dostosować wysokość według potrzeb
                menu.style.opacity = "1";
                menu.style.padding = "10px";
                menuToggle.innerHTML = "&#9654;";
            }
            menuVisible = !menuVisible;
        }

        function toggleStats() {
            statsVisible = !statsVisible;
            let stats = document.getElementById("stats");
            stats.style.display = statsVisible ? "block" : "none";
        }

        function changeBackground() {
            let newColor = getRandomColor();
            document.body.style.backgroundColor = newColor;
        }

        function updateMotionBlur(value) {
            motionBlur = value;
            document.getElementById("blurValue").innerText = value + "px";
        }

        function animateHeader() {
            let header = document.querySelector("#content h1");
            header.style.color = getRandomColor();
            header.style.transition = "all 0.5s";
            header.style.transform = "scale(1.2)";
            setTimeout(() => {
                header.style.transform = "scale(1)";
            }, 500);
        }

        update();
    </script>
</body>
</html>
