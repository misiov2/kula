<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animated Ball with Gravity</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div id="content">
        <h1>MISIEK</h1>
    </div>
    <div id="menuContainer">
        <div id="menuToggle" onclick="toggleMenu()">&#9664;</div>
        <div id="menu">
            <label for="ballColor">Ball Color:</label>
            <input type="color" id="ballColor" value="#ff0000">

            <label for="ballSize">Ball Size:</label>
            <input type="number" id="ballSize" value="50">

            <label for="ballSpeed">Ball Speed:</label>
            <input type="number" id="ballSpeed" value="2">

            <button onclick="addBall()">Add Ball</button>

            <label for="statsToggle">Show Stats:</label>
            <input type="checkbox" id="statsToggle" onchange="toggleStats()">

            <button onclick="changeBackground()">Change Background</button>
            <button onclick="clearBalls()">Clear Balls</button>

            <label for="blurAmount">Motion Blur:</label>
            <input type="range" id="blurAmount" min="0" max="10" value="0" onchange="updateBlur()">
        </div>
    </div>
    <div id="helpBox" onclick="toggleMenu()">?</div>
    <div id="stats">
        Bounce Count: <span id="bounceCount">0</span><br>
        Ball Count: <span id="ballCount">0</span>
    </div>

    <script>
        let balls = [];
        let gravity = 0.2;
        let bounceCounter = 0;
        let statsVisible = false;

        function addBall() {
            let size = document.getElementById("ballSize").value;
            let speed = document.getElementById("ballSpeed").value;
            let color = document.getElementById("ballColor").value;
            createBall(size, speed, color);
            updateBallCount();
        }

        function createBall(size, speed, color) {
            let ball = document.createElement("div");
            ball.className = "ball";
            ball.style.width = size + "px";
            ball.style.height = size + "px";
            ball.style.backgroundColor = color;
            ball.style.left = Math.random() * (window.innerWidth - size) + "px";
            ball.style.top = Math.random() * (window.innerHeight - size) + "px";
            document.body.appendChild(ball);
            balls.push({ element: ball, speedX: Math.random() * 10 - 5, speedY: parseFloat(speed) });
        }

        function update() {
            for (let i = 0; i < balls.length; i++) {
                let ball = balls[i];
                let currentTop = parseFloat(ball.element.style.top);
                let currentLeft = parseFloat(ball.element.style.left);
                let size = parseFloat(ball.element.style.height);

                // Gravity
                if (currentTop >= window.innerHeight - size) {
                    ball.speedY *= -0.9;
                    bounceCounter++;
                } else if (currentTop <= 0) {
                    ball.speedY *= -1;
                } else {
                    ball.speedY += gravity;
                }

                if (currentLeft <= 0 || currentLeft >= window.innerWidth - size) {
                    ball.speedX *= -1;
                }

                ball.element.style.top = Math.min(Math.max(currentTop + ball.speedY, 0), window.innerHeight - size) + "px";
                ball.element.style.left = Math.min(Math.max(currentLeft + ball.speedX, 0), window.innerWidth - size) + "px";
            }

            document.getElementById("bounceCount").innerText = bounceCounter;
            requestAnimationFrame(update);
        }

        function updateBlur() {
            let blurAmount = document.getElementById("blurAmount").value;
            for (let ball of balls) {
                ball.element.style.filter = `blur(${blurAmount}px)`;
            }
        }

        function changeBackground() {
            document.body.style.backgroundColor = '#' + Math.floor(Math.random() * 16777215).toString(16);
        }

        function clearBalls() {
            balls.forEach(ball => ball.element.remove());
            balls = [];
            bounceCounter = 0;
            updateBallCount();
            document.getElementById("bounceCount").innerText = bounceCounter;
        }

        function updateBallCount() {
            document.getElementById("ballCount").innerText = balls.length;
        }

        function toggleMenu() {
            let menu = document.getElementById("menuContainer");
            let toggleButton = document.getElementById("menuToggle");
            if (menu.style.transform === "translateX(-300px)") {
                menu.style.transform = "translateX(0)";
                toggleButton.innerHTML = "&#9664;";
            } else {
                menu.style.transform = "translateX(-300px)";
                toggleButton.innerHTML = "&#9654;";
            }
        }

        function toggleStats() {
            statsVisible = !statsVisible;
            let stats = document.getElementById("stats");
            stats.style.display = statsVisible ? "block" : "none";
        }

        update();
    </script>
</body>

</html>
